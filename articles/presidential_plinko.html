<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Presidential Plinko • plinko</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/paper/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Presidential Plinko">
<meta property="og:description" content="plinko">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-93322-5"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-93322-5');
</script>
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">plinko</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/presidential_plinko.html">Presidential Plinko</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="presidential_plinko_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Presidential Plinko</h1>
            
      
      
      <div class="hidden name"><code>presidential_plinko.Rmd</code></div>

    </div>

    
    
<style type="text/css">
.kable-table table {
  margin-left: 0;
}
img {
  border: none;
}
</style>
<p>The following code constructs a Plinko board for a quantile dotplot of a predictive distribution for the 2020 US Presidential election outcome.</p>
<p>See <a href="https://presidential-plinko.com">presidential-plinko.com</a> and the <a href="https://github.com/mjskay/election-galton-board">mjskay/election-galton-board</a> repository for more information.</p>
<div id="setup" class="section level2">
<h2 class="hasAnchor">
<a href="#setup" class="anchor"></a>Setup</h2>
<p>The following packages are required for this example:</p>
<div class="sourceCode" id="cb1"><pre class="downlit">
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">plinko</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span></pre></div>
<pre><code>## 
## Attaching package: 'dplyr'</code></pre>
<pre><code>## The following objects are masked from 'package:stats':
## 
##     filter, lag</code></pre>
<pre><code>## The following objects are masked from 'package:base':
## 
##     intersect, setdiff, setequal, union</code></pre>
<div class="sourceCode" id="cb5"><pre class="downlit">
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://mjskay.github.io/ggdist">ggdist</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggforce.data-imaginist.com">ggforce</a></span><span class="op">)</span>

<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme_get.html">theme_set</a></span><span class="op">(</span><span class="fu"><a href="http://mjskay.github.io/ggdist/reference/theme_ggdist.html">theme_ggdist</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></pre></div>
</div>
<div id="desired-target-sample" class="section level2">
<h2 class="hasAnchor">
<a href="#desired-target-sample" class="anchor"></a>Desired target sample</h2>
<p>Say we’ve taken 50 quantiles from a predictive distribution for the number of electoral votes Biden will receive in the 2020 US Presidential election:</p>
<div class="sourceCode" id="cb6"><pre class="downlit">
<span class="co"># this 20 quantiles from the Economist's forecast as of Sept 29, 2020.</span>
<span class="va">x</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">213</span>, <span class="fl">243</span>, <span class="fl">266</span>, <span class="fl">279</span>, <span class="fl">290</span>, <span class="fl">304</span>, <span class="fl">310</span>, <span class="fl">319</span>, <span class="fl">323</span>, <span class="fl">333</span>, <span class="fl">339</span>, <span class="fl">345</span>,  <span class="fl">352</span>, <span class="fl">357</span>, <span class="fl">363</span>, <span class="fl">372</span>, <span class="fl">374</span>, <span class="fl">385.125</span>, <span class="fl">399</span>, <span class="fl">415</span><span class="op">)</span>

<span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="http://mjskay.github.io/ggdist/reference/geom_dotsinterval.html">geom_dots</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">"Predicted electoral votes for Biden"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html">xlim</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">538</span><span class="op">)</span></pre></div>
<p><img src="presidential_plinko_files/figure-html/unnamed-chunk-1-1.png" width="700"></p>
<p>What we would like to do is construct a Plinko board that “sediments” into this dotplot. That is, it gives us an animation of a plausible random process that could have led to a dotplot that looks like the one above. This will take several steps.</p>
</div>
<div id="constructing-the-board" class="section level2">
<h2 class="hasAnchor">
<a href="#constructing-the-board" class="anchor"></a>Constructing the board</h2>
<p>First, to determine the board dimensions, we need to decide on the number of draws we will take and the number of pins in one row of the board (equivalently, the size of the Binomial distribution we are simulating with the board):</p>
<div class="sourceCode" id="cb7"><pre class="downlit">
<span class="va">n_bin</span> <span class="op">=</span> <span class="fl">6</span>
<span class="va">bin_width</span> <span class="op">=</span> <span class="fl">41</span></pre></div>
<p>Then we can construct the Plinko board:</p>
<div class="sourceCode" id="cb8"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">12345</span><span class="op">)</span>

<span class="va">board</span> <span class="op">=</span> <span class="fu"><a href="../reference/plinko_board.html">plinko_board</a></span><span class="op">(</span>
  <span class="va">x</span>, <span class="va">n_bin</span>, <span class="va">bin_width</span>, center <span class="op">=</span> <span class="fl">330.5</span>,
  limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">538</span><span class="op">)</span><span class="co">#, total_height = 2445</span>
<span class="op">)</span>

<span class="va">board</span></pre></div>
<pre><code>## A Plinko Board with 20 balls and 6 bins centered at 330.5</code></pre>
</div>
<div id="plotting-the-board" class="section level2">
<h2 class="hasAnchor">
<a href="#plotting-the-board" class="anchor"></a>Plotting the board</h2>
<div id="using-autoplot" class="section level3">
<h3 class="hasAnchor">
<a href="#using-autoplot" class="anchor"></a>Using <code>autoplot()</code>
</h3>
<p>The Plinko board will automatically find random paths the balls could have taken to end up in their final locations. We can see these paths by plotting the board with the <code><a href="https://ggplot2.tidyverse.org/reference/autoplot.html">autoplot()</a></code> function, which returns a <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot()</a></code> object:</p>
<div class="sourceCode" id="cb10"><pre class="downlit">
<span class="va">board</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html">autoplot</a></span><span class="op">(</span><span class="op">)</span></pre></div>
<p><img src="presidential_plinko_files/figure-html/unnamed-chunk-4-1.png" width="201.6"></p>
<p>By default the plot overlays the Binomial distribution implied by the Plinko board so you can judge the quality of the approximation. We can also turn this off:</p>
<div class="sourceCode" id="cb11"><pre class="downlit">
<span class="va">board</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html">autoplot</a></span><span class="op">(</span>show_dist <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></pre></div>
<p><img src="presidential_plinko_files/figure-html/unnamed-chunk-5-1.png" width="201.6"></p>
<p>You can also see the board without paths by passing <code>show_paths = FALSE</code>, and you can plot specific frames of the animation by passing the <code>frame</code> parameter:</p>
<div class="sourceCode" id="cb12"><pre class="downlit">
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html">autoplot</a></span><span class="op">(</span><span class="va">board</span>, show_paths <span class="op">=</span> <span class="cn">FALSE</span>, frame <span class="op">=</span> <span class="fl">9</span><span class="op">)</span></pre></div>
<p><img src="presidential_plinko_files/figure-html/unnamed-chunk-6-1.png" width="201.6"></p>
</div>
<div id="plotting-manually" class="section level3">
<h3 class="hasAnchor">
<a href="#plotting-manually" class="anchor"></a>Plotting manually</h3>
<p>We could also create a plot like the ones above manually by using the <code><a href="../reference/plinko_board-properties.html">slot_edges()</a></code>, <code><a href="../reference/plinko_board-properties.html">pins()</a></code>, <code><a href="../reference/plinko_board-properties.html">paths()</a></code>, and <code><a href="../reference/plinko_board-properties.html">balls()</a></code> unctions, which return data frames containing the locations of all of the elements of the board:</p>
<div class="sourceCode" id="cb13"><pre class="downlit">
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_segment.html">geom_segment</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="fl">0</span>, xend <span class="op">=</span> <span class="va">x</span>, yend <span class="op">=</span> <span class="va">height</span><span class="op">)</span>, data <span class="op">=</span> <span class="fu"><a href="../reference/plinko_board-properties.html">slot_edges</a></span><span class="op">(</span><span class="va">board</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"gray75"</span>, size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span>, data <span class="op">=</span> <span class="fu"><a href="../reference/plinko_board-properties.html">pins</a></span><span class="op">(</span><span class="va">board</span><span class="op">)</span>, shape <span class="op">=</span> <span class="fl">19</span>, color <span class="op">=</span> <span class="st">"#e41a1c"</span>, size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_path</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span>, group <span class="op">=</span> <span class="va">ball_id</span><span class="op">)</span>, data <span class="op">=</span> <span class="fu"><a href="../reference/plinko_board-properties.html">paths</a></span><span class="op">(</span><span class="va">board</span><span class="op">)</span>, alpha <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="fl">4</span>, size <span class="op">=</span> <span class="fl">1</span>, color <span class="op">=</span> <span class="st">"gray50"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggforce.data-imaginist.com/reference/geom_circle.html">geom_circle</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x0 <span class="op">=</span> <span class="va">x</span>, y0 <span class="op">=</span> <span class="va">y</span>, r <span class="op">=</span> <span class="va">width</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>, data <span class="op">=</span> <span class="fu"><a href="../reference/plinko_board-properties.html">balls</a></span><span class="op">(</span><span class="va">board</span><span class="op">)</span>, fill <span class="op">=</span> <span class="st">"#1f78b4"</span>, color <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_fixed.html">coord_fixed</a></span><span class="op">(</span>expand <span class="op">=</span> <span class="cn">FALSE</span>, clip <span class="op">=</span> <span class="st">"off"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="cn">NULL</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>
    axis.line.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,
    axis.line.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_line</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"gray75"</span>, size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>
  <span class="op">)</span> </pre></div>
<p><img src="presidential_plinko_files/figure-html/board_plot-1.png" width="201.6"></p>
<p>However, if you wish to customize the plot, it is probably easier to use the <code><a href="../reference/modify_layer.html">modify_layer()</a></code> and <code><a href="../reference/add_layers.html">add_layers()</a></code> functions described in the next section, as these also impact the frames used when an animated plot is rendered.</p>
</div>
</div>
<div id="customizing-frames" class="section level2">
<h2 class="hasAnchor">
<a href="#customizing-frames" class="anchor"></a>Customizing frames</h2>
<p>You can customize the existing layers in the <code>ggplot</code> objects generated for each frame using the <code><a href="../reference/modify_layer.html">modify_layer()</a></code> function, which takes a layer name followed by parameters you would normally pass to a ggplot layer/geom. Aesthetic mappings you provide are merged with the existing aesthetics in the layer, and new arguments you provide override existing ones.</p>
<p>For example, say you want to make the ball fill color depend on its x position, and change the outline color to be black:</p>
<div class="sourceCode" id="cb14"><pre class="downlit">
<span class="va">board</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/modify_layer.html">modify_layer</a></span><span class="op">(</span><span class="st">"balls"</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">x</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html">autoplot</a></span><span class="op">(</span>show_dist <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></pre></div>
<p><img src="presidential_plinko_files/figure-html/unnamed-chunk-7-1.png" width="288"></p>
<p>You can use <code><a href="../reference/modify_layer.html">modify_layer()</a></code> to adjust the following layers:</p>
<ul>
<li>“slot_edges”: A <code><a href="https://ggplot2.tidyverse.org/reference/geom_segment.html">geom_segment()</a></code> that draws the edges of the slots</li>
<li>“pins”: A <code><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point()</a></code> that draws the pins</li>
<li>“paths”: A <code><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_path()</a></code> that draws ball paths</li>
<li>“balls”: A <code><a href="https://ggforce.data-imaginist.com/reference/geom_circle.html">geom_circle()</a></code> that draws the balls</li>
<li>“dist”: A <code><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_step()</a></code> that draws the reference binomial distribution</li>
</ul>
<p>When plotting a single frame, you can also add additional ggplot objects after the call to <code><a href="https://ggplot2.tidyverse.org/reference/autoplot.html">autoplot()</a></code>, as with any ggplot object:</p>
<div class="sourceCode" id="cb15"><pre class="downlit">
<span class="va">board</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html">autoplot</a></span><span class="op">(</span>show_dist <span class="op">=</span> <span class="cn">FALSE</span>, show_paths <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">269</span>, color <span class="op">=</span> <span class="st">"black"</span>, alpha <span class="op">=</span> <span class="fl">0.15</span>, size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html">annotate</a></span><span class="op">(</span><span class="st">"label"</span>, x <span class="op">=</span> <span class="fl">269</span>, y <span class="op">=</span> <span class="fl">1500</span>, label <span class="op">=</span> <span class="st">"269"</span>, hjust <span class="op">=</span> <span class="fl">0.5</span>, color <span class="op">=</span> <span class="st">"gray50"</span><span class="op">)</span></pre></div>
<p><img src="presidential_plinko_files/figure-html/unnamed-chunk-8-1.png" width="201.6"></p>
<p>However, layers added in this way are not saved into the <code>board</code> object, and so <strong>will not be displayed when the board is animated</strong>.</p>
<p>To add ggplot objects to the <code>board</code> object so that they are displayed when the board is animated, you must use the <code><a href="../reference/add_layers.html">add_layers()</a></code> function <em>before</em> calling <code><a href="https://ggplot2.tidyverse.org/reference/autoplot.html">autoplot()</a></code> or <code><a href="https://gganimate.com/reference/animate.html">animate()</a></code>. Here is the same example using <code><a href="../reference/add_layers.html">add_layers()</a></code>:</p>
<div class="sourceCode" id="cb16"><pre class="downlit">
<span class="va">board</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/add_layers.html">add_layers</a></span><span class="op">(</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">269</span>, color <span class="op">=</span> <span class="st">"black"</span>, alpha <span class="op">=</span> <span class="fl">0.15</span>, size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html">annotate</a></span><span class="op">(</span><span class="st">"label"</span>, x <span class="op">=</span> <span class="fl">269</span>, y <span class="op">=</span> <span class="fl">1500</span>, label <span class="op">=</span> <span class="st">"269"</span>, hjust <span class="op">=</span> <span class="fl">0.5</span>, color <span class="op">=</span> <span class="st">"gray50"</span><span class="op">)</span>
  <span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html">autoplot</a></span><span class="op">(</span>show_dist <span class="op">=</span> <span class="cn">FALSE</span>, show_paths <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></pre></div>
<p><img src="presidential_plinko_files/figure-html/unnamed-chunk-9-1.png" width="201.6"></p>
<p>As static plots, both look identical. However, when we get to animating (next), we’ll have to use the <code><a href="../reference/add_layers.html">add_layers()</a></code> approach.</p>
</div>
<div id="animating-the-board" class="section level2">
<h2 class="hasAnchor">
<a href="#animating-the-board" class="anchor"></a>Animating the board</h2>
<p>By default, no tweening is done between balls on the board:</p>
<div class="sourceCode" id="cb17"><pre class="downlit">
<span class="va">board</span> <span class="op">%&gt;%</span>
  <span class="co"># width is determined automatically based on height</span>
  <span class="fu"><a href="https://gganimate.com/reference/animate.html">animate</a></span><span class="op">(</span>fps <span class="op">=</span> <span class="fl">7.5</span>, height <span class="op">=</span> <span class="fl">500</span><span class="op">)</span></pre></div>
<p><img src="presidential_plinko_files/figure-html/unnamed-chunk-10-1.gif"><!-- --></p>
<p>Most likely you will want some tweening between ball states. I find that using 4 times the base number of frames with a <code>"bounce-out"</code> easing function (the default) makes for a smooth animation that feels more physically accurate. You can add tweening using the <code><a href="../reference/tween_balls.html">tween_balls()</a></code> function. You’ll also want to increase the <code>fps</code> to account for the additional frames, and we will add a 3-second (90-frame) pause at the end of the animation using <code>end_pause</code>:</p>
<div class="sourceCode" id="cb18"><pre class="downlit">
<span class="va">board</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/tween_balls.html">tween_balls</a></span><span class="op">(</span>frame_mult <span class="op">=</span> <span class="fl">4</span>, ease <span class="op">=</span> <span class="st">"bounce-out"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://gganimate.com/reference/animate.html">animate</a></span><span class="op">(</span>fps <span class="op">=</span> <span class="fl">30</span>, height <span class="op">=</span> <span class="fl">500</span>, end_pause <span class="op">=</span> <span class="fl">90</span><span class="op">)</span></pre></div>
<p><img src="presidential_plinko_files/figure-html/unnamed-chunk-11-1.gif"><!-- --></p>
<p>For testing purposes (e.g. faster rendering), it can also be useful to filter the frames in the final animation. You can do this using <code><a href="../reference/filter_frames.html">filter_frames()</a></code>, which takes filtering conditions in the same format as <code><a href="https://dplyr.tidyverse.org/reference/filter.html">filter()</a></code> and applies them to the data frame returned by <code><a href="../reference/plinko_board-properties.html">frames(board)</a></code>. The <code>"ball_id"</code> column can be combined with the <code>"stopped"</code> column (which is <code>TRUE</code> after the ball hits the bottom of a slot and stops moving) to show just one ball dropping, for example:</p>
<div class="sourceCode" id="cb19"><pre class="downlit">
<span class="va">board</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/filter_frames.html">filter_frames</a></span><span class="op">(</span><span class="va">ball_id</span> <span class="op">==</span> <span class="fl">1</span>, <span class="op">!</span><span class="va">stopped</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/tween_balls.html">tween_balls</a></span><span class="op">(</span>frame_mult <span class="op">=</span> <span class="fl">4</span>, ease <span class="op">=</span> <span class="st">"bounce-out"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://gganimate.com/reference/animate.html">animate</a></span><span class="op">(</span>fps <span class="op">=</span> <span class="fl">30</span>, height <span class="op">=</span> <span class="fl">500</span><span class="op">)</span></pre></div>
<p><img src="presidential_plinko_files/figure-html/unnamed-chunk-12-1.gif"><!-- --></p>
</div>
<div id="a-full-annotated-board" class="section level2">
<h2 class="hasAnchor">
<a href="#a-full-annotated-board" class="anchor"></a>A full, annotated board</h2>
<p>Finally, we can combine everything together to adjust the existing geometries with <code><a href="../reference/modify_layer.html">modify_layer()</a></code>, add annotations with <code><a href="../reference/add_layers.html">add_layers()</a></code>, add tweening with <code><a href="../reference/tween_balls.html">tween_balls()</a></code>, then animate:</p>
<div class="sourceCode" id="cb20"><pre class="downlit">
<span class="va">Biden_color</span> <span class="op">=</span> <span class="st">"#0571b0"</span>
<span class="va">Trump_color</span> <span class="op">=</span> <span class="st">"#ca0020"</span>

<span class="va">annotation_height</span> <span class="op">=</span> <span class="fl">1400</span>

<span class="va">board</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/modify_layer.html">modify_layer</a></span><span class="op">(</span><span class="st">"pins"</span>, color <span class="op">=</span> <span class="st">"gray50"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="co"># the "balls" layer uses the frame(board) data frame, which has a "region"</span>
  <span class="co"># column giving the part of the board the ball is in ("start", "pin", or "slot")</span>
  <span class="co"># we can use this to change the ball color when it falls into the slot</span>
  <span class="fu"><a href="../reference/modify_layer.html">modify_layer</a></span><span class="op">(</span>
    <span class="st">"balls"</span>, 
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">region</span> <span class="op">==</span> <span class="st">"slot"</span>, <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">x</span> <span class="op">&lt;=</span> <span class="fl">269</span>, <span class="st">"Trump"</span>, <span class="st">"Biden"</span><span class="op">)</span>, <span class="st">"none"</span><span class="op">)</span><span class="op">)</span>,
    color <span class="op">=</span> <span class="cn">NA</span>
  <span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/add_layers.html">add_layers</a></span><span class="op">(</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">269</span>, color <span class="op">=</span> <span class="st">"black"</span>, alpha <span class="op">=</span> <span class="fl">0.15</span>, size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html">annotate</a></span><span class="op">(</span><span class="st">"text"</span>, 
      x <span class="op">=</span> <span class="fl">290</span>, y <span class="op">=</span> <span class="fl">0.92</span> <span class="op">*</span> <span class="va">annotation_height</span>,
      label <span class="op">=</span> <span class="st">"Biden wins"</span>, hjust <span class="op">=</span> <span class="fl">0</span>, color <span class="op">=</span> <span class="va">Biden_color</span>,
    <span class="op">)</span>,
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html">annotate</a></span><span class="op">(</span><span class="st">"text"</span>, 
      x <span class="op">=</span> <span class="fl">250</span>, y <span class="op">=</span> <span class="fl">0.92</span> <span class="op">*</span> <span class="va">annotation_height</span>,
      label <span class="op">=</span> <span class="st">"Trump wins"</span>, hjust <span class="op">=</span> <span class="fl">1</span>, color <span class="op">=</span> <span class="va">Trump_color</span>
    <span class="op">)</span>,
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html">annotate</a></span><span class="op">(</span><span class="st">"label"</span>, 
      x <span class="op">=</span> <span class="fl">269</span>, y <span class="op">=</span> <span class="fl">0.97</span> <span class="op">*</span> <span class="va">annotation_height</span>,
      label <span class="op">=</span> <span class="st">"269"</span>, hjust <span class="op">=</span> <span class="fl">0.5</span>, color <span class="op">=</span> <span class="st">"gray50"</span>,
      fontface <span class="op">=</span> <span class="st">"bold"</span>
    <span class="op">)</span>,
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/expand_limits.html">expand_limits</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">annotation_height</span><span class="op">)</span>,
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_fill_manual</a></span><span class="op">(</span>
      limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"none"</span>, <span class="st">"Biden"</span>, <span class="st">"Trump"</span><span class="op">)</span>,
      values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"gray45"</span>, <span class="va">Biden_color</span>, <span class="va">Trump_color</span><span class="op">)</span>, 
      guide <span class="op">=</span> <span class="cn">FALSE</span>
    <span class="op">)</span>,
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>axis.title.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>hjust <span class="op">=</span> <span class="fl">0</span>, size <span class="op">=</span> <span class="fl">10</span>, color <span class="op">=</span> <span class="st">"gray25"</span><span class="op">)</span><span class="op">)</span>,
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">"Electoral votes for Biden"</span><span class="op">)</span>
  <span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/tween_balls.html">tween_balls</a></span><span class="op">(</span>frame_mult <span class="op">=</span> <span class="fl">4</span>, ease <span class="op">=</span> <span class="st">"bounce-out"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://gganimate.com/reference/animate.html">animate</a></span><span class="op">(</span>fps <span class="op">=</span> <span class="fl">30</span>, height <span class="op">=</span> <span class="fl">500</span>, end_pause <span class="op">=</span> <span class="fl">90</span><span class="op">)</span></pre></div>
<p><img src="presidential_plinko_files/figure-html/unnamed-chunk-13-1.gif"><!-- --></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by <a href="http://www.mjskay.com">Matthew Kay</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
